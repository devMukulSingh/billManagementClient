import{j as e,r as x}from"./index-CVfE49ll.js";import{d as j}from"./index-oZfdXCXz.js";import{u as F,a as g,B as f,D as E,S as I,b as M,f as q}from"./index-DOh0zPzq.js";import{a as A,b as v,c as $,d as R,e as T,T as O,f as Q,D as B,M as V}from"./DeleteDialog-cewh-vCA.js";import{A as k}from"./AddProductDialog-BJw-AUYz.js";import{c as U}from"./utils-DgjiVB1k.js";import{u as P,V as N}from"./index-ZiYbebhz.js";import{u as z,t as L,z as p,F as G,b as h,c as y,d as b,e as D,f as S}from"./form-BKpDzj8W.js";import{I as C}from"./input-DzGSjn4M.js";import{B as w}from"./button-CSuLezZL.js";import{C as K}from"./circle-plus-NuuZ6w6j.js";import{S as H}from"./square-pen-DMC-qW8D.js";import{S as J}from"./shopping-bag-BNWG7lHb.js";import{u as W}from"./browser-DrVg5YfN.js";import"./createLucideIcon-DtXzPAI9.js";const X=p.object({name:p.string(),rate:p.coerce.number()});function Y({openDialog:o,setOpenDialog:r,product:n}){const i=P(),{userId:t}=j.useAuth(),{mutate:d,isPending:s}=F({mutationKey:["put_product"],mutationFn:async a=>await g.put(`${f}/${t}/product/${n.id}`,a),onSuccess:()=>{i.invalidateQueries({queryKey:["get_products"]}),i.invalidateQueries({queryKey:["get_all_products"]}),r(!1),N.success("Product updated",{position:"bottom-right"})}}),c=z({resolver:L(X),defaultValues:{name:n.name,rate:n.rate}});function m(){c.handleSubmit(a=>d(a))()}return e.jsx(E,{dialogContentClassName:"w-[25rem]",title:"Edit Product",open:o,titleIcon:K,onClose:()=>r(!1),children:e.jsxs("form",{className:"space-y-5",children:[e.jsxs(G,{...c,children:[e.jsx(h,{disabled:s,name:"name",control:c.control,render:({field:a})=>e.jsxs(y,{children:[e.jsx(b,{children:"Name"}),e.jsx(D,{children:e.jsx(C,{...a,onKeyUp:u=>u.stopPropagation()})}),e.jsx(S,{})]})}),e.jsx(h,{disabled:s,name:"rate",control:c.control,render:({field:a})=>e.jsxs(y,{children:[e.jsx(b,{children:"Rate ₹"}),e.jsx(D,{children:e.jsx(C,{...a,onKeyUp:u=>u.stopPropagation()})}),e.jsx(S,{})]})})]}),e.jsx(w,{disabled:s,type:"button",onClick:m,children:"Create"})]})})}function Z({children:o,product:r}){const n=P(),[i,t]=x.useState(!1),[d,s]=x.useState(!1),{userId:c}=j.useAuth(),{mutate:m,isPending:a}=F({mutationKey:["delete_product"],mutationFn:async l=>await g.delete(`${f}/${c}/product/${l.id}`),onSuccess:()=>{n.invalidateQueries({queryKey:["get_products"]}),n.invalidateQueries({queryKey:["get_all_products"]}),N.success("product deleted"),t(!1)}}),u=[{label:"Edit",icon:H,onSelect:()=>s(!0),className:""},{label:"Delete",icon:O,onSelect:()=>t(!0),className:""}];return e.jsxs(e.Fragment,{children:[e.jsx(Y,{product:r,openDialog:d,setOpenDialog:s}),i&&e.jsx(A,{disabled:a,title:"Are you sure?",onDelete:()=>m({id:r.id}),open:i,description:"This action cant be undone",onClose:()=>t(!1)}),e.jsxs(v,{children:[e.jsx($,{asChild:!0,children:o}),e.jsx(R,{className:"",children:e.jsx(T,{children:u.map((l,_)=>e.jsxs(Q,{className:U("flex items-center gap-2 cursor-pointer",l.className),onClick:l.onSelect,children:[e.jsx(l.icon,{size:15}),l.label]},_))})})]})]})}function fe(){return e.jsxs("div",{className:`\r
      flex-col \r
      border-red-600\r
      h-full\r
      w-full\r
      flex \r
      gap-5\r
      px-5\r
      py-5\r
    `,children:[e.jsx(ee,{}),e.jsx(I,{className:"border-white border"}),e.jsx(se,{})]})}function ee(){const[o,r]=x.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx(k,{openDialog:o,setOpenDialog:r}),e.jsxs("header",{className:`\r
        flex \r
        items-center\r
        justify-between\r
        gap-2 \r
      `,children:[e.jsxs("div",{className:`      \r
          items-center\r
          flex \r
          gap-2 \r
          `,children:[e.jsx(J,{}),e.jsx("h1",{className:"text-2xl sm:text-3xl font-semibold",children:"Manage Products"})]}),e.jsxs(w,{onClick:()=>r(!0),variant:"outline",children:[e.jsx(K,{}),"Add Product"]})]})]})}function se(){const{userId:o}=j.useAuth(),[r]=W(),n=r.get("page")||1,i=10,{data:t}=M({queryKey:["get_products"],queryFn:async()=>(await g.get(`${f}/${o}/product/get-products`,{params:{page:n,limit:i}})).data}),d=[{accessorKey:"id",header:"Id"},{accessorKey:"name",header:"Name"},{accessorKey:"rate",header:"Rate",cell:({row:s})=>e.jsxs(e.Fragment,{children:["₹ ",s.original.rate]})},{accessorKey:"created_at",header:"Date",cell:({row:s})=>e.jsxs(e.Fragment,{children:[" ",q(s.original.created_at,"Pp")]})},{id:"actions",cell:({row:s})=>e.jsx(Z,{product:s.original,children:e.jsx(V,{className:"cursor-pointer"})})}];return e.jsx(B,{renderSubComponent:()=>e.jsx(e.Fragment,{}),columns:d,data:t==null?void 0:t.data})}export{fe as default};
