import{j as e,a as f,r as j}from"./index-CVfE49ll.js";import{D as x,a as N,b as D,c as K,d as S,e as C,T as M,f as _,M as P}from"./DeleteDialog-cewh-vCA.js";import{u as w,a as g,B as b,b as E,S as T,f as F}from"./index-DOh0zPzq.js";import{c as v}from"./utils-DgjiVB1k.js";import{u as A,V as $}from"./index-ZiYbebhz.js";import{d as y}from"./index-oZfdXCXz.js";import{S as q}from"./square-pen-DMC-qW8D.js";import{u as R}from"./browser-DrVg5YfN.js";import{P as V}from"./package-DBjgMSOw.js";import{C as B,a as I}from"./chevron-up-Zz_Bt0yl.js";import"./createLucideIcon-DtXzPAI9.js";import"./button-CSuLezZL.js";const Q=[{accessorKey:"product.name",header:"Name"},{accessorKey:"product.rate",header:"Rate"},{accessorKey:"quantity",header:"Quantity"},{accessorKey:"amount",header:"Amount"}];function k({row:n}){const r=n.original.bill_items;return e.jsx(e.Fragment,{children:e.jsx(x,{columns:Q,data:r,renderSubComponent:()=>e.jsx(e.Fragment,{})})})}function H({children:n,bill:r,isOpenDialog:l,setIsOpenDialog:o}){const i=f(),c=A(),{userId:a}=y.useAuth(),{isPending:d,mutate:u}=w({mutationKey:["delete_bill"],mutationFn:async t=>{await g.delete(`${b}/${a}/bill/${t.id}`)},onSuccess:()=>{c.invalidateQueries({queryKey:["get_bills"]}),o(!1),$.success("bill deleted")}}),m=[{label:"Edit",icon:q,onSelect:()=>i(`/edit-bill/${r.id}`),className:""},{label:"Delete",icon:M,onSelect:()=>o(!0),className:""}];return e.jsxs(e.Fragment,{children:[l&&e.jsx(N,{disabled:d,onDelete:()=>u({id:r.id}),description:"This action can't be undone",open:l,onClose:()=>o(!1),title:"Are you sure?"}),e.jsxs(D,{children:[e.jsx(K,{asChild:!0,children:n}),e.jsx(S,{className:"",children:e.jsx(C,{children:m.map((t,s)=>e.jsxs(_,{className:v("flex items-center gap-2 cursor-pointer",t.className),onClick:t.onSelect,children:[e.jsx(t.icon,{size:15}),t.label]},s))})})]})]})}function ae({}){const[n,r]=j.useState(!1),[l]=R(),o=Number(l.get("page"))||1,i=10,{userId:c}=y.useAuth(),{data:a,isFetching:d,isPending:u}=E({queryKey:["get_bills"],queryFn:async()=>(await g.get(`${b}/${c}/bill/get-bills`,{params:{page:o,limit:i}})).data}),m=[{accessorKey:"distributor.id",header:"id"},{accessorKey:"distributor.name",header:"Distributor"},{accessorKey:"domain.name",header:"Domain"},{accessorKey:"expander",header:"Products",cell:({row:s})=>{var p,h;return e.jsxs("button",{onClick:s.getToggleExpandedHandler(),className:"flex gap-3",children:[(h=(p=s.original)==null?void 0:p.bill_items)==null?void 0:h.length,s.getIsExpanded()?e.jsx(B,{}):e.jsx(I,{})]})}},{accessorKey:"total_amount",header:"Total amount",cell:({row:s})=>`â‚¹${s.original.total_amount}`},{accessorKey:"is_paid",header:"Paid",cell:({row:s})=>s.getValue("is_paid")?"Yes":"No"},{accessorKey:"date",header:"Date",cell:({row:s})=>F(s.getValue("date"),"dd-MM-yyyy | H:m")},{id:"actions",header:"",cell:({row:s})=>e.jsx(H,{bill:s.original,isOpenDialog:n,setIsOpenDialog:r,children:e.jsx(P,{className:"cursor-pointer"})})}],t=Math.ceil(((a==null?void 0:a.count)||1)/i);return e.jsx(e.Fragment,{children:e.jsxs("div",{className:`
        flex-col
        gap-5
        flex
        h-full border-2
        `,children:[e.jsxs("header",{className:"space-y-2 p-5",children:[e.jsxs("h1",{className:`
            sm:text-3xl 
            text-2xl 
            font-medium
            text-neutral-800
            flex
            items-center
            gap-2
            border-2
        `,children:[e.jsx(V,{}),"All Bills"]}),e.jsx(T,{className:"border-white border"})]}),d||u?e.jsx(e.Fragment,{children:"loading..."}):e.jsx(x,{className:"min-h-[calc(100vh-12rem)]",columns:m,data:(a==null?void 0:a.data)||[],totalPages:t,renderSubComponent:k})]})})}export{ae as default};
