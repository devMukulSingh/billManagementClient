import{j as e,r as p}from"./index-CVfE49ll.js";import{d as x}from"./index-oZfdXCXz.js";import{u as b,a as f,B as g,D as _,S as N,b as w,f as C}from"./index-DOh0zPzq.js";import{a as F,b as P,c as E,d as K,e as M,T as q,f as v,D as A,M as I}from"./DeleteDialog-cewh-vCA.js";import{D as O,a as $,A as Q}from"./AddDistributorDialog-DHilJ0vC.js";import{c as T}from"./utils-DgjiVB1k.js";import{u as h,V as D}from"./index-ZiYbebhz.js";import{u as k,t as R,F as V}from"./form-BKpDzj8W.js";import{b as B}from"./schema-Dy7N3xTd.js";import{B as j}from"./button-CSuLezZL.js";import{C as y}from"./circle-plus-NuuZ6w6j.js";import{S as z}from"./square-pen-DMC-qW8D.js";import{P as U}from"./package-DBjgMSOw.js";import{u as G}from"./browser-DrVg5YfN.js";import"./createLucideIcon-DtXzPAI9.js";import"./input-DzGSjn4M.js";import"./chevron-up-Zz_Bt0yl.js";const H=B.pick({distributor_name:!0,domain_id:!0});function L({openDialog:i,setOpenDialog:t,distributor:r}){const l=h(),{userId:s}=x.useAuth(),{mutate:c,isPending:n}=b({mutationKey:["update_distributor"],mutationFn:async a=>await f.put(`${g}/${s}/distributor/${r.id}`,a),onSuccess:()=>{l.invalidateQueries({queryKey:["get_distributors"]}),l.invalidateQueries({queryKey:["get_all_distributors"]}),t(!1),D.success("Distributor Updated",{position:"bottom-right"})}}),o=k({resolver:R(H),defaultValues:{distributor_name:r.name,domain_id:r.domain.id}});function d(a){a.stopPropagation();const m=o.getValues();c(m)}return e.jsx(_,{title:"Edit distributor",open:i,titleIcon:y,onClose:()=>t(!1),children:e.jsxs("form",{className:"space-y-10",children:[e.jsxs(V,{...o,children:[e.jsx(O,{form:o,isPending:n}),e.jsx($,{form:o,isPending:n})]}),e.jsx(j,{disabled:n,type:"button",onClick:d,children:"Submit"})]})})}function J({children:i,distributor:t}){const r=h(),[l,s]=p.useState(!1),[c,n]=p.useState(!1),{userId:o}=x.useAuth(),{mutate:d,isPending:a}=b({mutationKey:["delete_distributor"],mutationFn:async u=>await f.delete(`${g}/${o}/distributor/${u.id}`),onSuccess:()=>{r.invalidateQueries({queryKey:["get_distributors"]}),r.invalidateQueries({queryKey:["get_all_distributors"]}),D.success("distributor deleted"),s(!1)}}),m=[{label:"Edit",icon:z,onSelect:()=>n(!0),className:""},{label:"Delete",icon:q,onSelect:()=>s(!0),className:""}];return e.jsxs(e.Fragment,{children:[e.jsx(L,{distributor:t,openDialog:c,setOpenDialog:n}),l&&e.jsx(F,{disabled:a,title:"Are you sure?",onDelete:()=>d({id:t.id}),open:l,description:"This action cant be undone",onClose:()=>s(!1)}),e.jsxs(P,{children:[e.jsx(E,{asChild:!0,children:i}),e.jsx(K,{className:"",children:e.jsx(M,{children:m.map((u,S)=>e.jsxs(v,{className:T("flex items-center gap-2 cursor-pointer",u.className),onClick:u.onSelect,children:[e.jsx(u.icon,{size:15}),u.label]},S))})})]})]})}function fe({}){return e.jsxs("div",{className:`\r
      flex-col\r
      h-full\r
      w-full\r
      px-10\r
      py-5\r
      flex\r
      gap-5\r
    `,children:[e.jsx(W,{}),e.jsx(N,{className:"border-white border"}),e.jsx(X,{})]})}function W(){const[i,t]=p.useState(!1);return e.jsxs(e.Fragment,{children:[i&&e.jsx(Q,{openDialog:i,setOpenDialog:t}),e.jsxs("header",{className:`\r
        w-full \r
        justify-between\r
        flex \r
        items-center \r
      `,children:[e.jsxs("div",{className:"flex gap-2 items-center ",children:[e.jsx(U,{size:30}),e.jsx("h1",{className:`\r
            font-semibold \r
            underline-offset-1\r
            text-2xl\r
            sm:text-3xl \r
      `,children:"Manage Distributors"})]}),e.jsxs(j,{variant:"outline",onClick:()=>t(!0),children:[e.jsx(y,{}),"Add distributor"]})]})]})}function X(){const[i]=G(),t=i.get("page")||"1",r=10,{userId:l}=x.useAuth(),{data:s,isFetching:c,isPending:n}=w({queryKey:["get_distributors",t],queryFn:async()=>(await f.get(`${g}/${l}/distributor/get-distributors`,{params:{page:t,limit:r}})).data}),o=[{accessorKey:"id",header:"Id"},{accessorKey:"name",header:"Name"},{accessorKey:"created_at",header:"Date created",cell:({row:a})=>e.jsxs(e.Fragment,{children:[C(a.original.created_at,"Pp")," "]})},{accessorKey:"domain.name",header:"Domain"},{id:"actions",cell:({row:a})=>e.jsx(J,{distributor:a.original,children:e.jsx(I,{className:"cursor-pointer"})})}],d=Math.ceil(((s==null?void 0:s.count)||1)/r);return e.jsx(e.Fragment,{children:c||n?e.jsx(e.Fragment,{children:"loading..."}):e.jsx(A,{className:"min-h-[calc(100vh-7rem)]",totalPages:d,renderSubComponent:()=>e.jsx(e.Fragment,{}),data:s==null?void 0:s.data,columns:o})})}export{fe as default};
