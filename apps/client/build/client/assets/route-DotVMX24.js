import{j as e,r as p}from"./index-CVfE49ll.js";import{d as x}from"./index-oZfdXCXz.js";import{u as h,a as f,B as g,D as N,S as _,b as w,f as C}from"./index-DOh0zPzq.js";import{a as F,b as P,c as E,d as M,e as K,T as q,f as v,D as A,M as I}from"./DeleteDialog-cewh-vCA.js";import{D as O,A as $}from"./AddDomainDialog-C8iWH7sR.js";import{c as Q}from"./utils-DgjiVB1k.js";import{u as D,V as j}from"./index-ZiYbebhz.js";import{u as T,t as k,F as R}from"./form-BKpDzj8W.js";import{b as V}from"./schema-Dy7N3xTd.js";import{B as y}from"./button-CSuLezZL.js";import{C as b}from"./circle-plus-NuuZ6w6j.js";import{S as B}from"./square-pen-DMC-qW8D.js";import{P as z}from"./package-DBjgMSOw.js";import{u as U}from"./browser-DrVg5YfN.js";import"./createLucideIcon-DtXzPAI9.js";import"./input-DzGSjn4M.js";const G=V.pick({domain_name:!0});function H({openDialog:t,setOpenDialog:a,domain:o}){const r=D(),{userId:s}=x.useAuth(),{mutate:m,isPending:i}=h({mutationKey:["put_domain"],mutationFn:async n=>await f.put(`${g}/${s}/domain/${o.id}`,n),onSuccess:()=>{r.invalidateQueries({queryKey:["get_domains"]}),r.invalidateQueries({queryKey:["get_all_domains"]}),a(!1),j.success("Domain Updated",{position:"bottom-right"})}}),l=T({resolver:k(G),defaultValues:{domain_name:o.name}});function d(n){n.stopPropagation();const u=l.getValues();m(u)}return e.jsx(N,{title:"Edit domain",open:t,titleIcon:b,onClose:()=>a(!1),children:e.jsxs("form",{className:"space-y-10",children:[e.jsx(R,{...l,children:e.jsx(O,{form:l,isPending:i})}),e.jsx(y,{disabled:i,type:"button",onClick:d,children:"Submit"})]})})}function L({children:t,domain:a}){const o=D(),[r,s]=p.useState(!1),[m,i]=p.useState(!1),{userId:l}=x.useAuth(),{mutate:d,isPending:n}=h({mutationKey:["delete_domain"],mutationFn:async c=>await f.delete(`${g}/${l}/domain/${c.id}`),onSuccess:()=>{o.invalidateQueries({queryKey:["get_domains"]}),o.invalidateQueries({queryKey:["get_all_domains"]}),j.success("Domain deleted"),s(!1)}}),u=[{label:"Edit",icon:B,onSelect:()=>i(!0),className:""},{label:"Delete",icon:q,onSelect:()=>s(!0),className:""}];return e.jsxs(e.Fragment,{children:[e.jsx(H,{domain:a,openDialog:m,setOpenDialog:i}),r&&e.jsx(F,{disabled:n,title:"Are you sure?",onDelete:()=>d({id:a.id}),open:r,description:"This action cant be undone",onClose:()=>s(!1)}),e.jsxs(P,{children:[e.jsx(E,{asChild:!0,children:t}),e.jsx(M,{className:"",children:e.jsx(K,{children:u.map((c,S)=>e.jsxs(v,{className:Q("flex items-center gap-2 cursor-pointer",c.className),onClick:c.onSelect,children:[e.jsx(c.icon,{size:15}),c.label]},S))})})]})]})}function pe({}){return e.jsxs("div",{className:`\r
      flex-col\r
      h-full\r
      w-full\r
      px-10\r
      py-5\r
      flex\r
      gap-5\r
    `,children:[e.jsx(J,{}),e.jsx(_,{className:"border-white border"}),e.jsx(W,{})]})}function J(){const[t,a]=p.useState(!1);return e.jsxs(e.Fragment,{children:[t&&e.jsx($,{openDialog:t,setOpenDialog:a}),e.jsxs("header",{className:`\r
        justify-between\r
        flex \r
        items-center \r
        w-full \r
      `,children:[e.jsxs("div",{className:"flex gap-2 items-center ",children:[e.jsx(z,{size:30}),e.jsx("h1",{className:`\r
            sm:text-3xl \r
            font-semibold \r
            underline-offset-1\r
            text-2xl\r
      `,children:"Manage Domains"})]}),e.jsxs(y,{variant:"outline",onClick:()=>a(!0),children:[e.jsx(b,{}),"Add Domain"]})]})]})}function W(){const[t]=U(),a=t.get("page")||"1",o=10,{userId:r}=x.useAuth(),{data:s,isFetching:m,isPending:i}=w({queryKey:["get_domains",a],queryFn:async()=>(await f.get(`${g}/${r}/domain/get-domains`,{params:{page:a,limit:o}})).data}),l=[{accessorKey:"id",header:"Id"},{accessorKey:"name",header:"Name"},{accessorKey:"created_at",header:"Date created",cell:({row:n})=>e.jsxs(e.Fragment,{children:[C(n.original.created_at,"Pp")," "]})},{id:"actions",cell:({row:n})=>e.jsx(L,{domain:n.original,children:e.jsx(I,{className:"cursor-pointer"})})}],d=Math.ceil(((s==null?void 0:s.count)||1)/o);return e.jsx(e.Fragment,{children:m||i?e.jsx(e.Fragment,{children:"loading..."}):e.jsx(A,{className:"min-h-[calc(100vh-7rem)]",renderSubComponent:()=>e.jsx(e.Fragment,{}),data:s==null?void 0:s.data,totalPages:d,columns:l})})}export{pe as default};
